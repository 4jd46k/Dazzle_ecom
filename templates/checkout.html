<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
  <meta name="generator" content="Jekyll v3.8.5">
  <title>Dazzle | Checkout</title>
  {% load static %}
  <link rel="icon" type="image/png" href="{% static 'images/logo.png' %}">

  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">

  <link href="{% static 'fonts/fontawesome/css/all.min.css' %}" type="text/css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.10.0/dist/sweetalert2.min.css" rel="stylesheet">
  <!-- Bootstrap core CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

</head>

<body class="bg-light">
<style>
    .button {
 --color: #222121;
 background-color: transparent;
 border-radius: .3em;
 position: relative;
 overflow: hidden;
 cursor: pointer;
 transition: .5s;
 font-weight: 200;
 font-size: 17px;
 border: 1px solid;
 font-family: inherit;
 text-transform: uppercase;
 color: var(--color);
 z-index: 1;
}

.button::before, .button::after {
 content: '';
 display: block;
 width: 50px;
 height: 50px;
 transform: translate(-50%, -50%);
 position: absolute;
 border-radius: 50%;
 z-index: -1;
 background-color: var(--color);
 transition: 1s ease;
}

.button::before {
 top: -1em;
 left: -1em;
}

.button::after {
 left: calc(100% + 1em);
 top: calc(100% + 1em);
}

.button:hover::before, .button:hover::after {
 height: 410px;
 width: 410px;
}

.button:hover {
 color: rgb(255, 255, 255);
}

.button:active {
 filter: brightness(.8);
}

.Btnn {
  width: 130px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #46c24c;
  border: none;
  color: white;
  font-weight: 600;
  gap: 8px;
  cursor: pointer;
  box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.103);
  position: relative;
  overflow: hidden;
  transition-duration: .3s;
}

.svgIcon {
  width: 16px;
}

.svgIcon path {
  fill: white;
}

.Btnn::before {
  width: 130px;
  height: 130px;
  position: absolute;
  content: "";
  background-color: rgb(14, 21, 201);
  border-radius: 50%;
  left: -100%;
  top: 0;
  transition-duration: .3s;
  mix-blend-mode: difference;
}

.Btnn:hover::before {
  transition-duration: .3s;
  transform: translate(100%,-50%);
  border-radius: 0;
}

.Btnn:active {
  transform: translate(5px,5px);
  transition-duration: .3s;
}


.loader {
  position: relative;
}

.loader span {
  position: absolute;
  color: #fff;
  transform: translate(-50%, -50%);
  font-size: 38px;
  letter-spacing: 5px;
}

.loader span:nth-child(1) {
  color: transparent;
  -webkit-text-stroke: 0.3px rgb(19, 60, 226);
}

.loader span:nth-child(2) {
  color: rgb(128, 198, 255);
  -webkit-text-stroke: 1px rgb(19, 134, 229);
  animation: uiverse723 3s ease-in-out infinite;
}

@keyframes uiverse723 {
  0%, 100% {
    clip-path: polygon(0% 45%, 15% 44%, 32% 50%, 
     54% 60%, 70% 61%, 84% 59%, 100% 52%, 100% 100%, 0% 100%);
  }

  50% {
    clip-path: polygon(0% 60%, 16% 65%, 34% 66%, 
     51% 62%, 67% 50%, 84% 45%, 100% 46%, 100% 100%, 0% 100%);
  }
}

</style>
  <!-- Jumbotron -->
  <div class="p-3 text-center bg-white border-bottom shadow">
    <div class="d-flex justify-content-center">
      <div class="col-1 text-center ">
        
        <a href="{% url 'home' %}" class="brand-wrap">
          <img class="logo img-fluid  my-3" src="{% static 'images/logo.png' %}" alt="Logo">
          <div class="loader ">
              <span>DazzLe</span>
              <span>DazzLe</span>
          </div>
      </a> <!-- brand-wrap.// -->
    <small><small class="mt-3 d-block">UMBRELLA</small></small>
      </div>
    </div>
  </div>
  <!-- Jumbotron -->
  </header>

  <!-- Content Section -->
  <section class="py-5 ">
    <div class="container">
      <div class="row">
        <div class="col-lg-6">

          <!-- ============================================================================== -->
          <!-- =====================  WHO IS LOGGED IN  ============================ -->
          <!-- ============================================================================== -->

          <div class="card mb-4 shadow bg-light">
            <div class="py-2 ps-4 d-flex justify-content-between">
              <div class="">
                {% if user.is_authenticated %}
                <div class="h6 text-body-secondaryry "><span class="badge bg-secondary"> Logged in
                    as</span></div>
                <div class="h6">{{ user}} - {{ user.email }}</div>
                {% endif %}
              </div>
            </div>
          </div>

          <!-- ============================================================================== -->
          <!-- ========================== ADDRESS ============================ -->
          <!-- ============================================================================== -->
          <div class="shadow mb-2 p-3 ">
            <div class="d-flex justify-content-between">
              <div class="h6 text-body-secondary"><span class="badge bg-secondary">DELIVERY ADDRESS</span>
              </div>
              <button class="btn btn-sm btn-outline-dark fw-semibold" data-bs-toggle="modal"
                data-bs-target="#add_address" type="button">Add New</button>
            </div>
            <div class="border my-2 p-2">
              <div class="form-check d-flex justify-content-between">
                <div id="selectedaddress"></div>
                <div class="d-flex">
                  <button class="btn btn-outline-dark btn-sm fw-semibold my-auto" data-bs-toggle="modal"
                    data-bs-target="#change_address" type="button">Change</button>
                </div>
              </div>
            </div>
            <div class="modal fade" id="change_address" tabindex="-1" data-bs-backdrop="static" aria-hidden="true">
              <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content">
                  <div class="modal-header">
                    <h6 class="modal-title fs-5" id="exampleModalLabel"><span class="badge bg-secondary">Change
                        Address</span></h6>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>
                  <div class="modal-body p-2">
                    {% for user_address in user_addresses %}
                    <div class="form-check border mb-2">
                      <div class="p-2">
                        <input class="form-check-input addresscheck" type="radio" name="address"
                          id="{{ user_address.id }}" {% if forloop.first %}checked{% endif %} onchange="updateHiddenInputs()">
                        <label class="form-check-label" for="{{ user_address.id }}">
                          <div>{{ user_address.gender }}. {{ user_address.first_name }} {{ user_address.last_name }}-
                            {{ user_address.mobile }}</div>
                          <div>{{ user_address.address }}</div>
                          <div>{{ user_address.place }} - {{ user_address.pincode }}</div>
                        </label>
                      </div>
                    </div>
                    {% endfor %}

                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-outline-info" value="Save" onclick="updateaddress()"
                      data-bs-dismiss="modal">Select </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ============================================================================== -->
          <!-- =================== CART ITEMS ========================= -->
          <!-- ============================================================================== -->
          <h5 class=" my-3"><span class="badge bg-secondary">Items in cart</span></h5>
          <div class="container ">
            {% for item in cart_items %}
            <div class="card bg-light shadow m-1  ">
              <div class="card-body">
                <div class="d-flex justify-content-evenly">
                  <div class=" p-2 ">
                    <img src="{{ item.product_variant.cover_image.url }}" style="height: 150px; width: 150px;"
                      class="img-sm rounded border-0" />
                  </div>
                  <div class="">
                    <h6 class="fw-bolder">{{ item.product_variant.product.name }}</h6>
                    <hr class="pb-1">
                    
                    <div class="d-flex">
                      <div>
                       
                        <span class=" fw-lighter ">Color
                          :
                          {{ item.product_variant.color_name }} </span>
                          <hr class="">
                      </div>
                    </div>

                    <div class="d-flex justify-content-between  align-items-center">
                      <div class="fw-ligh me-3">
                        Count : {{ item.count }}
                        <hr class="">
                      </div>
                      <div class="text-dark ">Price :
                        â‚¹{{ item.total_selling_price }}
                        <hr class="">
                      </div>
                      
                    </div>
                  </div>
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>



        <div class="col-lg-6">
          <!-- ============================================================================== -->
          <!-- =================== SUMMARY ========================= -->
          <!-- ============================================================================== -->
          <div class="  ms-3  custom-border">
            <h6 class="my-2"><span class="badge bg-secondary">Summary</span></h6>
            <div class="d-flex justify-content-between">
              <p class="mb-2">Total Price:</p>
              <p class="mb-2">â‚¹{{cart.total_selling_price}}</p>
            </div>
            <div class="d-flex justify-content-between">
              <p class="mb-2">Coupon Discount:</p>
              <p class="mb-2 text-danger">- â‚¹ {{coupon_discount}} </p>
            </div>
            <div class="d-flex justify-content-between">
              <p class="mb-2">Delivery Charge:</p>
              <p class="mb-2 text-success">FREE</p>
            </div>
            <hr />
            <div class="d-flex justify-content-between mb-2 fw-bold">
              <p class="mb-2">Final Price:</p>
              <p class="mb-2 ">â‚¹{{final_price}}</p>
            </div>
            <!-- ============================================================================== -->
            <!-- =================== COUPONS ====================== -->
            <!-- ============================================================================== -->
            <div class="card bg-light shadow">
              <h5 class="ms-3 mt-3"><span class="badge bg-secondary">Apply Coupon</span></h5>

              <div class="card-body">
                <div class="input-group mb-4">
                  <input type="text" class="form-control border couponchecked" id="couponCodeInput" name="coupon_code" value=""
                    placeholder="Select a coupon from below and apply" />
                  <button class="btn btn-outline-light text-success border" onclick="apply_coupon()">Apply</button>
                  <button class="btn btn-outline-light text-danger border" onclick="clear_coupon()"><i
                      class="fas fa-trash"></i></button>
                </div>

                <div class="p-2" style="height: 150px; overflow-y: auto;">
                  <div class="coupon-container">
                    {% if coupons %}
                    {% for coupon in coupons %}
                    <div class="form-check border mb-2">
                      <div class="p-2">
                        <input class="form-check-input coupon-radio coupon" type="radio" name="coupon" value="{{ coupon.id }}"
                          id="coupon{{ forloop.counter }}" data-coupon-code="{{ coupon.coupon_code }}" onchange="updateAppliedCouponId()">
                        <label class="form-check-label" for="coupon{{ forloop.counter }}">
                          <div>
                            {{ coupon.coupon_code }}
                          </div>
                          <div>
                            â‚¹{{ coupon.discount_amount }} {{ coupon.description }} â‚¹{{ coupon.minimum_amount }}
                          </div>
                        </label>
                      </div>
                    </div>
                    {% endfor %}
                    {% else %}
                    <p class="text-center" style="font-size: 0.80em;">No coupons available for the
                      current total
                      price.&#128546; <br> Add more products to unlock Coupons.&#128526;</p>
                    {% endif %}
                  </div>
                </div>

              </div>
            </div>

            <!-- =================================================================================== -->
            <!-- ========================== PAYMENT METHOD ============================= -->
            <!-- ================================================================================== -->

            <div class="card shadow mt-4 bg-light">
              <div class="card-body">
                <h6 class="card-title"><span class="badge bg-secondary">Payment Method</span></h6>

                <form class="my-2" id="payment" action="{% url 'checkout' %}" method="post">
                  {% csrf_token %}
                  <input type="hidden" id="addressInput" name="hiddenaddress" value="">
                  <input type="hidden" id="pay" name="pay" value="">
                  <div class="border d-flex gap-3 mb-2 p-2">
                    <button type="submit" class="btn btn-outline-light text-primary btn-sm border border-3 border-primary "
                      id="cod-button" onclick="payy()">Cash On Delivery<i class="fa-solid fa-hand-holding-dollar p-1"></i></button>

                        <button type="submit" class="Btnn  btn-sm" id="rzp-button1">
                          Pay Online
                          <svg class="svgIcon" viewBox="0 0 576 512"><path d="M512 80c8.8 0 16 7.2 16 16v32H48V96c0-8.8 7.2-16 16-16H512zm16 144V416c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V224H528zM64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H512c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zm56 304c-13.3 0-24 10.7-24 24s10.7 24 24 24h48c13.3 0 24-10.7 24-24s-10.7-24-24-24H120zm128 0c-13.3 0-24 10.7-24 24s10.7 24 24 24H360c13.3 0 24-10.7 24-24s-10.7-24-24-24H248z"></path></svg>
                        </button>

                  </div>
                </form>
              </div>
            </div>

            <div class="p-3">
              <a href="{% url 'cart' %}" type="button" class="btn btn-outline-dark btn-sm mr-2 button" data-mdb-ripple-init><i
                  class="fa fa-arrow-circle-left "></i> Go Back To Cart</a>
            </div>
          </div>
        </div>
      </div>


      <!-- ============================================================================== -->
      <!-- ============ ADD NEW ADDRESS MODAL DATA ============= -->
      <!-- ============================================================================== -->


      <div class="modal fade" id="add_address" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
        aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable hiddenscrollbar">
          <div class="modal-content">
            <div class="modal-header">
              <h6 class="modal-title fs-5" id="exampleModalLabel"><span class="badge bg-secondary"> Add
                  New Address</span>
              </h6>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form id="addressform" action="{% url 'add_address' %}" method="post">
                {% csrf_token %}
                <label for="address_type">Address Type</label>
                <select name="address_type" id="address_type" class="form-select mb-2">
                  <option value="Home" selected>Home</option>
                  <option value="Office">Office</option>
                </select>

                <label for="first_name">First Name</label>
                <input type="text" name="first_name" id="first_name" class="form-control mb-2" required>

                <label for="last_name">Last Name</label>
                <input type="text" name="last_name" id="last_name" class="form-control mb-2" required>

                <label for="gender">Gender</label>
                <select name="gender" id="gender" class="form-select mb-2">
                  <option value="Mr" selected>Male</option>
                  <option value="Mrs">Female</option>
                </select>

                <label for="mobile">Mobile</label>
                <input type="text" name="mobile" id="mobile" class="form-control mb-2" required>

                <label for="email">Email</label>
                <input type="email" name="email" id="email" class="form-control mb-2" required>

                <label for="address">Address</label>
                <textarea name="address" id="address" class="form-control mb-2" rows="3"></textarea>

                <label for="place">Place</label>
                <input type="text" name="place" id="place" class="form-control mb-2" required>

                <label for="landmark">Land Mark</label>
                <input type="text" name="landmark" id="landmark" class="form-control mb-2" required>

                <label for="addpincode">Pincode</label>
                <input type="text" name="pincode" id="addpincode" class="form-control mb-2"
                  onkeyup="fetchPincodeData(this,'addpinhelp','addpostoffice','adddistrict','addstate')"
                  aria-describedby="addpinhelp" required>
                <div id="addpinhelp" class="form-text text-danger"></div>

                <label for="addpostoffice">Post Office</label>
                <select class="form-select" name="post" id="addpostoffice"></select>

                <label for="adddistrict">District:</label>
                <input type="text" class="form-control mb-2" name="district" id="adddistrict" readonly>

                <label for="addstate">State:</label>
                <input type="text" class="form-control mb-2" name="state" id="addstate" readonly>
              </form>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
              <input type="submit" onclick="saveaddress()" class="btn btn-primary" value="Save">
            </div>
          </div>
        </div>
      </div>
  </section>

  <!-- Footer -->
  <footer class="text-center text-lg-start text-muted  mt-3" style="background-color: #78BB7B">
    <!-- Section: Links  -->
    <section class="shadow">
      <div class="container text-center text-md-start pt-4 pb-4">
        <!-- Grid row -->
        <div class="row mt-3">
          <!-- Grid column -->
          <div class="col-12 col-lg-6 col-sm-12 mb-2">
            <!-- Content -->
            <a href="{% url 'home' %}" target="_blank" class="text-white h2">
              DAZZLE UMBRELLA
            </a>
            <p class="mt-1 text-white">
              Â© 2024@<a href="https://github.com/ajin-em"><i class="fa-brands fa-github"></i> Ajin E M</a> 
            </p>
          </div>
          <!-- Grid column -->
        </div>
        <!-- Grid row -->
      </div>
    </section>
    <!-- Section: Links  -->

    <div class="" style="background-color: rgba(0, 0, 0, 0.1)">
      <div class="container">
        <div class="d-flex justify-content-between py-4 border-top">

          <div>
            <i class="fab fa-lg fa-cc-visa text-white"></i>
            <i class="fab fa-lg fa-cc-amex text-white"></i>
            <i class="fab fa-lg fa-cc-mastercard text-white"></i>
            <i class="fab fa-lg fa-cc-paypal text-white"></i>
          </div>
        </div>
      </div>
    </div>

    </div>
    <script src="https://kit.fontawesome.com/c187aa525a.js" crossorigin="anonymous"></script>


    <script>

    function updateHiddenInputs() {
        const checkedAddressElement = document.querySelector('.addresscheck:checked');
        const hidden_address = document.getElementById('addressInput');
        if (checkedAddressElement) {
            hidden_address.value = checkedAddressElement.id;
        }
    }

    const addressElements = document.getElementsByClassName('addresscheck');
    for (let i = 0; i < addressElements.length; i++) {
        addressElements[i].addEventListener('change', updateHiddenInputs);
    }

    const addressValue = addressElements.length > 0 ? addressElements[0].value : '';
    document.getElementById('addressInput').value = addressValue;
    
    </script>
    

    <script>
      const couponRadios = document.querySelectorAll('.coupon-radio');
      let selectedRadioValue = localStorage.getItem('selectedRadioValue');
      let couponCodeInputValue = localStorage.getItem('couponCodeInputValue');

      couponRadios.forEach(radio => {
        radio.addEventListener('click', function () {
          couponRadios.forEach(radio => {
            radio.removeAttribute('checked');
          });
          this.setAttribute('checked', 'checked');
          const selectedCouponCode = this.parentElement.querySelector('.form-check-label div:first-child').innerText.trim();
          var coupon_id = this.value;
          document.getElementById('couponCodeInput').value = selectedCouponCode;

          localStorage.setItem('selectedRadioValue', this.value);
          localStorage.setItem('couponCodeInputValue', selectedCouponCode);
        });
      });

      function apply_coupon() {
        const checkedRadio = document.querySelector('.coupon-radio:checked');
        if (checkedRadio) {
            let currentUrl = new URL(window.location.href);
            let urlparams = new URLSearchParams(currentUrl.search);
            urlparams.set('coupon', checkedRadio.value);
            currentUrl.search = urlparams.toString();
            window.location.href = currentUrl.toString();
            const couponCode = checkedRadio.parentElement.querySelector('.form-check-label div:first-child').innerText.trim();
            const successMessage = `Coupon "${couponCode}" applied successfully!`;
            alert(successMessage);
        } else {
            alert('Please select a coupon before applying.');
        }
    }

    function clear_coupon() {
        let currentUrl = new URL(window.location.href);
        let urlparams = new URLSearchParams(currentUrl.search);
        urlparams.delete('coupon');
        currentUrl.search = urlparams.toString();
        window.location.href = currentUrl.toString();
        //alert('Coupon cleared successfully!');
    }

      document.addEventListener("DOMContentLoaded", function () {
        const selectedRadio = document.querySelector(`.coupon-radio[value="${selectedRadioValue}"]`);
        if (selectedRadio) {
          selectedRadio.setAttribute('checked', 'checked');
          document.getElementById('couponCodeInput').value = couponCodeInputValue;
        }
      });

      function clear_coupon() {
        fetch('{% url "clear_coupon" %}', { method: 'POST' })
          .then(response => {
            if (response.redirected) {
              window.location.href = response.url;
            }
          })
          .catch(error => {
            console.error('Error clearing coupon:', error);
          });

        localStorage.removeItem('selectedRadioValue');
        localStorage.removeItem('couponCodeInputValue');
        document.getElementById('couponCodeInput').value = '';
        const checkedRadio = document.querySelector('.coupon-radio:checked');
        if (checkedRadio) {
          checkedRadio.checked = false;
        }
      }


      function updateAppliedCouponId() {
    const selectedCoupon = document.querySelector('.coupon-radio:checked');
    if (selectedCoupon) {
        const couponId = selectedCoupon.value;
        const appliedCouponIdInput = document.getElementById('appliedCouponId');
        appliedCouponIdInput.value = couponId;
    }
}


couponRadios.forEach(radio => {
    radio.addEventListener('change', updateAppliedCouponId);
});

updateAppliedCouponId();
    </script>

    <script>
      function saveorder() {
        orderform = document.getElementById('orderform')
        orderform.submit()
      }
      function saveaddress() {
        addressform = document.getElementById('addressform')
        addressform.submit()
      }
      function setcoupon(code, discount) {
        const couponcodeinput = document.getElementById('couponcodeinput')
        couponcodeinput.value = code
        changeinput();
      }
      function changeinput() {
        let coupon = document.getElementById("couponcodeinput").value;
        let coupondivs = document.querySelectorAll('[name="coupondiv"]')
        let savings = document.getElementById('savings')
        let coupon_submit = document.getElementById('coupon_submit')
        let flag = false
        for (let i = 0; i < coupondivs.length; i++) {
          let coupondetails = coupondivs[i].querySelector('[name="coupondetails"]');
          let expirey = coupondivs[i].querySelector('[name="expirey"]');
          let button = coupondivs[i].querySelector('[type="button"]');
          if (coupondivs[i].id == `coupondiv${coupon}`) {
            coupondivs[i].classList.add('bg-primary')
            coupondetails.classList.add("text-light")
            expirey.classList.add("text-light")
            button.classList.add("text-light")
            discount = coupondetails.getAttribute('discount')
            savings.textContent = `â‚¹ ${discount}`
            coupon_submit.href = coupon_submit.href.replace('None', coupon)
            flag = true
          }
          else {
            coupondivs[i].classList.remove('bg-primary')
            coupondetails.classList.remove("text-light")
            expirey.classList.remove("text-light")
            button.classList.remove("text-light")
          }
        }
        if (flag == false) {
          savings.textContent = 'â‚¹ 0'
          coupon_submit.href = coupon_submit.href.replace(coupon, 'None')
        }
      }
      function fetchPincodeData(pincodeInput, helptext, postoffice, district, state) {
        const dropdown = document.getElementById(postoffice);
        const pincode = pincodeInput.value;
        dropdown.innerHTML = '';
        if (pincode.length !== 6) {
          document.getElementById(helptext).textContent = 'PIN code must be 6 characters long.';
          pincodeInput.classList.add('is-invalid');
          pincodeInput.classList.remove('is-valid');
          return;
        }
        else {
          document.getElementById(helptext).textContent = '';
          pincodeInput.classList.remove('is-invalid');
          pincodeInput.classList.add('is-valid');
        }
        const apiUrl = `https://api.postalpincode.in/pincode/${pincode}`;
        fetch(apiUrl)
          .then(response => response.json())
          .then(data => {
            if (data && data[0] && data[0].Status === 'Success') {
              const postofficeData = data[0].PostOffice.map(item => item.Name);
              postofficeData.forEach(name => {
                const option = document.createElement('option');
                option.value = name;
                option.text = name;
                dropdown.appendChild(option);
              });
              document.getElementById(district).value = data[0].PostOffice[0].District;
              document.getElementById(state).value = data[0].PostOffice[0].State;
            } else {
              document.getElementById(helptext).textContent = 'Invalid PIN Code';
              pincodeInput.classList.add('is-invalid');
            }
          })
          .catch(error => {
            document.getElementById(helptext).textContent = 'An error occurred while fetching data.';
          });
      }
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const initiallyCheckedRadio = document.querySelector("input[name='address']:checked");
        const HiddenInput = document.getElementById('addressInput')
        HiddenInput.value = initiallyCheckedRadio.id
        if (initiallyCheckedRadio) {
          const radiolabel = initiallyCheckedRadio.parentElement.querySelector("label");
          const selectedaddress = document.getElementById('selectedaddress');
          selectedaddress.innerHTML = radiolabel.innerHTML;
        }
      });
      function updateaddress() {
        const selectedradio = document.querySelector("input[name='address']:checked");
        const radiolabrl = selectedradio.parentElement.querySelector("label");
        const selectedaddress = document.getElementById('selectedaddress')
        selectedaddress.innerHTML = radiolabrl.innerHTML;
      }

    </script>



    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
      crossorigin="anonymous"></script>
    <script>window.jQuery || document.write('<script src="/docs/4.3/assets/js/vendor/jquery-slim.min.js"><\/script>')</script>
    <script src="https://getbootstrap.com/docs/4.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-xrRywqdh3PHs8keKZN+8zzc5TX0GRTLCcmivcbNJWm2rs5C8PRhcEn3czEjhAO9o"
      crossorigin="anonymous"></script>
    <script src="https://getbootstrap.com/docs/4.3/examples/checkout/form-validation.js"></script>


    {% comment %} payment {% endcomment %}
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.10.0/dist/sweetalert2.all.min.js"></script>

    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>


    <script>
      let pay=document.getElementById('pay')
      function payy(){
        pay.value='cod'

      }
      var payment_form = document.getElementById('payment')
      var options = {
          "key": "rzp_test_TsgQnf79q7ZDBa", 
          "amount": "{{payment.amount}}",
          "currency": "INR",
          "name": "Dazzle Umbrella",
          "description": "Test Transaction",
          "image": "https://example.com/your_logo",
          "order_id": "{{payment.id}}", 
          "handler": function (response){
              
              pay.value='online'
              payment_form.submit()
          },
          "prefill": {
              "name": "Gaurav Kumar",
              "email": "gaurav.kumar@example.com",
              "contact": "9000090000"
          },
          "notes": {
              "address": "Razorpay Corporate Office"
          },
          "theme": {
              "color": "#3399cc"
          }
      };
      var rzp1 = new Razorpay(options);
      rzp1.on('payment.failed', function (response){
              alert(response.error.code);
              alert(response.error.description);
              alert(response.error.source);
              alert(response.error.step);
              alert(response.error.reason);
              alert(response.error.metadata.order_id);
              alert(response.error.metadata.payment_id);
      });
      document.getElementById('rzp-button1').onclick = function(e){
          rzp1.open();
          e.preventDefault();
      }
      
    </script>
    <script>
      function saveorder() {
        // Display SweetAlert confirmation for Cash on Delivery
        Swal.fire({
          title: 'Confirm Cash on Delivery',
          text: 'Are you sure you want to proceed with Cash on Delivery?',
          icon: 'info',
          showCancelButton: true,
          confirmButtonColor: '#3085d6',
          cancelButtonColor: '#d33',
          confirmButtonText: 'Yes, proceed!',
          cancelButtonText: 'Cancel'
        }).then((result) => {
          if (result.isConfirmed) {
            // If user confirms, submit the form for Cash on Delivery
            const orderform = document.getElementById('orderform');
            orderform.submit();
          }
        });
      }
    </script>

    
</body>

</html>